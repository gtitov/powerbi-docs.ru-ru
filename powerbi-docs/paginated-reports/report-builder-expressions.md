---
title: Выражения в построителе отчетов BI Power
description: Выражения часто применяются в отчетах Power BI Report Builder для извлечения, вычисления, отображения, группирования, сортировки, фильтрации, параметризации и форматирования данных.
author: maggiesMSFT
ms.author: maggies
ms.date: 06/06/2019
ms.service: powerbi
ms.subservice: report-builder
ms.topic: conceptual
ms.assetid: 76d3ac86-650c-46fe-8086-8b3edcea3882
ms.openlocfilehash: 24f9348bf23c8e5748121f6967fe7c826984adb9
ms.sourcegitcommit: 653e18d7041d3dd1cf7a38010372366975a98eae
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/01/2020
ms.locfileid: "96416354"
---
# <a name="expressions-in-power-bi-report-builder"></a>Выражения в построителе отчетов BI Power

[!INCLUDE [applies-to](../includes/applies-to.md)] [!INCLUDE [yes-service](../includes/yes-service.md)] [!INCLUDE [yes-paginated](../includes/yes-paginated.md)] [!INCLUDE [yes-premium](../includes/yes-premium.md)] [!INCLUDE [no-desktop](../includes/no-desktop.md)] 

Выражения часто применяются в отчетах Power BI Report Builder для извлечения, вычисления, отображения, группирования, сортировки, фильтрации, параметризации и форматирования данных. 
  
Многие свойства элементов отчета могут быть заданы в виде выражений. С помощью выражений можно управлять содержимым, внешним видом и интерактивными возможностями отчета. Выражения составляются на языке Microsoft Visual Basic, сохраняются в определении отчета и вычисляются обработчиком отчетов при запуске отчета.  
  
 В отличие от приложений, таких как Microsoft Office Excel, где можно работать с данными напрямую на листе, в отчете вы работаете с выражениями, являющимися заполнителями для данных. Чтобы просмотреть фактические данные из вычисленных выражений, необходимо просмотреть отчет. При запуске отчета обработчик отчета вычисляет каждое выражение, объединяя данные отчета и элементы макета отчета, такие как таблицы и диаграммы.  
  
 При конструировании отчета многие выражения для элементов отчета будут уже заданы. Например, если перетащить поле с панели данных в ячейку таблицы в области конструктора отчета, в качестве значения текстового поля будет задано простое выражение для поля. На следующем рисунке область данных отчета отображает такие поля наборов данных, как ID, Name, SalesTerritory, Code и Sales. В таблицу добавлено три поля: [Name], [Code] и [Sales]. Обозначение [Name] в области конструктора представляет базовое выражение `=Fields!Name.Value`.  
  
![Режим конструктора в построителе отчетов](media/report-builder-expressions/report-builder-data-design-preview.png)
  
 При предварительном просмотре отчета обработчик отчетов комбинирует табличную область данных с фактическими данными из подключения к данным и отображает строку в таблице для каждой строки в результирующем наборе.  
  
 Чтобы ввести выражения вручную, выберите элемент в области конструктора и с помощью контекстных меню и диалоговых окон задайте свойства этого элемента. Когда появится кнопка * **(fx)** _ или значение `<Expression>` в раскрывающемся списке, значит, вы можете задать для свойства выражение. 
  
##  <a name="understanding-simple-and-complex-expressions"></a><a name="Types"></a> Общие сведения о простых и сложных выражениях  
 Выражения начинаются со знака равенства (=) и записываются на языке Microsoft Visual Basic. Они могут включать сочетание констант, операторов и ссылок на встроенные значения (поля, коллекции и функции), а также на внешний и пользовательский код.  
  
 Выражения можно использовать, чтобы задавать значения различных свойств элементов отчета. Самыми распространенными свойствами являются значения для текстовых полей и текста заполнителя. Как правило, если текстовое поле содержит только одно выражение, это выражение является значением для свойства текстового поля. Если текстовое поле содержит несколько выражений, каждое выражение является значением текста заполнителя в текстовом поле.  
  
 По умолчанию выражения отображаются в области конструктора отчета как _простые* или *сложные*.  
  
-   **Простое.** Простое выражение содержит ссылку на единственный элемент во встроенной коллекции, например поле набора данных, параметр или встроенное поле. В области конструктора простое выражение отображается в скобках. Например, `[FieldName]` соответствует базовому выражению `=Fields!FieldName.Value`. Простые выражения создаются автоматически по мере создания макета отчета и перетаскивания элементов из панели данных отчета на панель конструктора. Дополнительные сведения о символах, представляющих различные встроенные коллекции, см. в разделе [Основные сведения о символах префиксов в простых выражениях](#DisplayText).  
  
-   **Сложные.** Сложные выражения содержат ссылки на несколько встроенных ссылок, операторов и вызовов функций. Сложное выражение отображается как <\<Expr>>, если значение выражения включает больше чем простую ссылку. Для просмотра выражения наведите на него курсор и воспользуйтесь подсказкой. Чтобы изменить выражение, откройте его в диалоговом окне **Выражение** .  
  
 На следующем рисунке показаны типичные простые и сложные выражения как для текстовых полей, так и для текста заполнителя.  
  
![Формат по умолчанию для выражения построителя отчетов](media/report-builder-expressions/report-builder-expression-default-format.png) 
  
 Чтобы вместо текста выражений отобразить образцы значений, примените форматирование к текстовому полю или к тексту заполнителя. На следующем рисунке показана область конструктора отчетов с отображением образцов значений.  
  
![Формат примера выражения построителя отчетов](media/report-builder-expressions/report-builder-expression-sample-values-format.png)  


## <a name="understanding-prefix-symbols-in-simple-expressions"></a><a name="DisplayText"></a> Общие сведения о символах префиксов в простых выражениях  

В простых выражениях используются символы, чтобы указать, ссылается ли оно на поле, параметр, встроенную коллекцию или коллекцию ReportItems. В следующей таблице показаны примеры отображаемого текста и текста выражения.  
  
|Item|Пример отображаемого текста|Пример текста выражения|  
|----------|--------------------------|-----------------------------|  
|Поля набора данных|`[Sales]`<br /><br /> `[SUM(Sales)]`<br /><br /> `[FIRST(Store)]`|`=Fields!Sales.Value`<br /><br /> `=Sum(Fields!Sales.Value)`<br /><br /> `=First(Fields!Store.Value)`|  
|Параметры отчета|`[@Param]`<br /><br /> `[@Param.Label]`|`=Parameters!Param.Value`<br /><br /> `=Parameters!Param.Label`|  
|Встроенные поля|`[&ReportName]`|`=Globals!ReportName.Value`|  
|Литеральные символы для отображения текста|`\[Sales\]`|`[Sales]`|  
  
##  <a name="writing-complex-expressions"></a><a name="References"></a> Написание сложных выражений  
 Выражения могут включать ссылки на функции, операторы, константы, поля, параметры и элементы из встроенных коллекций, а также ссылки на внедренный пользовательский код или пользовательские сборки.  
  
 В следующей таблице перечислены типы ссылок, которые можно включать в выражение.  
  
|Ссылки|Описание|Пример|  
|----------------|-----------------|-------------|  
|Константы|Описывает константы для свойств, требующих постоянных значений, таких как цвет шрифта; к этим константам можно получить доступ в диалоговом режиме.|`="Blue"`|  
|Операторы|Описывает операторы, которые можно использовать для объединения ссылок в выражении. Например, оператор **&** используется для объединения строк.|`="The report ran at: " & Globals!ExecutionTime & "."`|  
|Встроенные коллекции|Описывает встроенные коллекции, которые можно включить в выражение, например `Fields`, `Parameters`и `Variables`.|`=Fields!Sales.Value`<br /><br /> `=Parameters!Store.Value`<br /><br /> `=Variables!MyCalculation.Value`|  
|Встроенные функции отчета и агрегатные функции|Описывает встроенные функции, такие как `Sum` и `Previous`, к которым можно получить доступ из выражения.|`=Previous(Sum(Fields!Sales.Value))`|  
|Пользовательский код и ссылки на сборки в выражениях в построителе отчетов |Описывает, как можно обратиться к встроенным классам среды CLR `xref:System.Math` и `xref:System.Convert`, другим классам среды CLR, функциям библиотеки времени выполнения Visual Basic или методам из внешней сборки.<br /><br /> Описывает, как получить доступ к пользовательскому коду, внедренному в отчет или скомпилированному и установленному в виде пользовательской сборки на клиент отчета и сервер отчетов.|`=Sum(Fields!Sales.Value)`<br /><br /> `=CDate(Fields!SalesDate.Value)`<br /><br /> `=DateAdd("d",3,Fields!BirthDate.Value)`<br /><br /> `=Code.ToUSD(Fields!StandardCost.Value)`|  
   
##  <a name="validating-expressions"></a><a name="Valid"></a> Проверка выражений  
 При создании выражения для определенного свойства элемента отчета типы ссылок, которые могут быть включены в выражение, зависят от значений, которые может принимать свойство элемента отчета, и от области, в которой это свойство вычисляется. Пример:  
  
-   По умолчанию выражение [Sum] вычисляет сумму данных, находящихся в области в момент вычисления выражения. Для табличной ячейки область зависит от членства групп строк и столбцов. 
  
-   Применительно к значению свойства Font это значение должно представлять название шрифта.  
  
-   Синтаксис выражения проверяется во время разработки. При публикации отчета происходит проверка области выражения. При проверке, зависящей от фактических данных, ошибки могут быть выявлены только в ходе выполнения. Некоторые из этих выражений выдают #Error в качестве сообщения об ошибке в подготовленном отчете. 

## <a name="next-steps"></a>Дальнейшие действия

- [Сведения об отчетах с разбивкой на страницы в Power BI Premium](paginated-reports-report-builder-power-bi.md)
