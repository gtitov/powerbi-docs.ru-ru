---
title: Включение и отключение самостоятельной регистрации и приобретения
description: Инструкции для администраторов по отключению возможности регистрации в службе Power BI и приобретения или продления лицензий для пользователей.
author: mihart
ms.author: mihart
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-admin
ms.topic: how-to
ms.date: 01/31/2021
ms.custom: licensing support
LocalizationGroup: Administration
ms.openlocfilehash: 80e263cc6e67c28b7593fcf10aea4c81c9f4af86
ms.sourcegitcommit: f7330dabb9cd8bce90bb2efec3e3273a11578f10
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/03/2021
ms.locfileid: "99494312"
---
# <a name="enable-or-disable-self-service-sign-up-and-purchasing"></a>Включение и отключение самостоятельной регистрации и приобретения

## <a name="what-is-self-service"></a>Что такое самообслуживание

Под самообслуживанием понимается наличие у пользователей организации (предприятия или учебного заведения) возможности подписываться на службы, оплачиваемые в рамках подписки организации, или использовать бесплатные службы без дополнительных действий со стороны организации. Пользователь переходит на веб-сайт Майкрософт, находит облачную службу, которую предлагает организация, и регистрируется в ней, используя свой рабочий или учебный адрес электронной почты. 

Часто бывает так, что организация уже оплатила подписку на эту службу. Возможна также ситуация, когда пользователь регистрируется в службе первым и становится ее администратором. Пробные или бесплатные лицензии приобретать не требуется. Но за службу Power BI Pro организация должна производить оплату ежемесячно. 

Администратору Microsoft 365 видно, кто подписывается на пробные версии, а также запрашивает платные лицензии и подписки.

> [!NOTE]
> Самостоятельная регистрация доступна только клиентам коммерческого облака, но не национальных облаков или облаков для государственных организаций.

## <a name="when-to-use-self-service-sign-up-and-purchase"></a>Когда следует использовать самостоятельную регистрацию и приобретение

### <a name="self-service-is-a-good-idea"></a>Рекомендуемые сценарии 

- Крупные децентрализованные организации (предприятия или учебные заведения), пользователям которых часто предоставляется возможность приобретать лицензии SaaS (программное обеспечение как услуга) для собственных нужд. 
- Организации с одним сотрудником и небольшие организации, которым нужно приобрести всего одну или несколько лицензий Power BI Pro.
- Пользователи, которые хотели бы опробовать службу Power BI и изучить ее возможности, прежде чем приобретать подписку для всей организации.
- Пользователи, у которых уже есть бесплатная лицензия Power BI и которые теперь хотят создавать содержимое и делиться им, перейдя на пробную версию Power BI Pro. 

### <a name="you-may-want-to-disable-self-service-when"></a>Ситуации, в которых рекомендуется отключение

- В организации установлены процессы закупок для выполнения нормативно-правовых требований, требований к безопасности и управлению. Все лицензии Power BI Pro должны утверждаться и контролироваться в соответствии с этими процессами. 
- В организации предъявляются требования к новым пользователям Power BI Pro, например обязательное обучение или подтверждение ознакомления с политиками защиты данных.
- В организации запрещено использовать службу Power BI из-за опасений по поводу конфиденциальности данных или других проблем, поэтому назначение бесплатных лицензий Power BI требует строгого контроля.
- Все лицензии Power BI Pro должны подпадать под Соглашение Enterprise, чтобы действовали договорные тарифы или скидки.
- У пользователей уже есть бесплатные лицензии Power BI, но им предлагается опробовать Power BI Pro или сразу приобрести лицензию. Повышение уровня лицензии может быть нежелательно из соображений безопасности, конфиденциальности или экономии затрат.


## <a name="enable-and-disable-self-service"></a>Включение и отключение самообслуживания

Администратор решает, следует ли включать или отключать самостоятельную регистрацию. Он также определяет, могут ли пользователи в организации самостоятельно покупать лицензии для себя. 

При отключенной самостоятельной регистрации пользователи не смогут изучать возможности визуализации и анализа данных в Power BI. Если вы заблокируете индивидуальную регистрацию, мы рекомендуем вам получить лицензии Power BI (бесплатная версия) для организации и назначить их всем пользователям. 

> [!NOTE]
>Если вы приобрели Power BI через поставщика облачных решений Майкрософт (CSP), самостоятельная регистрация пользователей может быть заблокирована. Поставщик CSP также может выступать в роли глобального администратора вашей организации. В этом случае для изменения данного параметра потребуется обратиться к нему.
>


 Для изменения параметров, контролирующих возможность самостоятельной регистрации и приобретения, используются команды PowerShell. 

- Чтобы полностью отключить возможность самостоятельной регистрации, измените в Azure Active Directory параметр **AllowAdHocSubscriptions** с помощью команд Azure AD PowerShell. Чтобы [включить или отключить самостоятельную регистрацию](#enable-or-disable-self-service-sign-up-for-your-organization), выполните инструкции, описанные в этой статье. Этот параметр отключает самостоятельную регистрацию для *всех* облачных приложений и служб Майкрософт.

- Чтобы запретить пользователям самостоятельно покупать лицензии Pro, измените параметр **AllowSelfServicePurchase** с помощью команд MSCommerce в PowerShell. Этот параметр позволяет отключить самостоятельное приобретение для отдельных продуктов. Чтобы [включить или отключить самостоятельное приобретение лицензий Power BI Pro](#enable-or-disable-self-service-purchase-in-your-organization), выполните инструкции, описанные в этой статье.

## <a name="enable-or-disable-self-service-sign-up-for-your-organization"></a>Включение и отключение самостоятельной регистрации для организации

Когда самостоятельная регистрация включена, параметр **AllowAdHocSubscriptions** имеет значение *true*. Давайте посмотрим, что произойдет, если изменить его на *false*.

- Новые пользователи в вашей организации не смогут регистрироваться индивидуально. Пользователи, которые зарегистрировались в Power BI до изменения этого параметра, сохраняют свои лицензии.

- Пользователи, у которых уже есть лицензия Power BI (бесплатная версия), по-прежнему могут регистрироваться для получения пробной версии Power BI Pro для частных лиц.

- Администратору потребуется назначить лицензии Power BI всем новым пользователям, которым они нужны.

### <a name="before-you-begin"></a>Подготовка

В этих инструкциях для изменения значения параметра **AllowAdHocSubscriptions** используются команды PowerShell для Azure Active Directory. Чтобы они стали доступны, необходимо установить модуль PowerShell для Azure AD. Дополнительные сведения об использовании PowerShell см. в статье [Начало работы с Windows PowerShell](/powershell/scripting/getting-started/getting-started-with-windows-powershell).

Чтобы установить модуль Azure AD, запустите Windows PowerShell от имени администратора. Убедитесь в том, что локальная политика выполнения позволяет выполнять скрипты. Если возникли проблемы, см. раздел [Политики выполнения PowerShell](/powershell/module/microsoft.powershell.core/about/about_execution_policies#powershell-execution-policies), чтобы узнать, как изменить локальную политику.

Чтобы установить модуль Azure AD, выполните следующую команду.

```powershell
Install-Module MSOnline
```

### <a name="change-the-self-service-signup-policy"></a>Изменение политики самостоятельной регистрации

В PowerShell выполните следующую команду, чтобы подключиться к Azure AD.

```powershell
Connect-MsolService
```

Введите учетные данные администратора в диалоговом окне входа и при необходимости пройдите двухфакторную проверку подлинности. После проверки вы вернетесь в окно PowerShell.

Чтобы просмотреть текущее значение параметра, выполните указанную ниже команду. Выходные данные передаются в отформатированный список с помощью параметра fl.

```powershell
Get-MsolCompanyInformation | fl AllowAdHocSubscriptions
```

Чтобы изменить текущее значение, выполните указанную ниже команду.

```powershell
Set-MsolCompanySettings -AllowAdHocSubscriptions $false
```

После выполнения этой команды самостоятельная регистрация отключается для всех пользователей. Чтобы снова включить ее, выполните эту команду еще раз, задав значение $true.

## <a name="enable-or-disable-self-service-purchase-in-your-organization"></a>Включение и отключение самостоятельного приобретения для организации

Если самостоятельное приобретение включено, параметр **AllowSelfServicePurchase** имеет значение *true*. Давайте посмотрим, что произойдет, если изменить его на *false*.

- Пользователи в организации не смогут самостоятельно покупать лицензии Power BI Pro. Пользователи, которые купили лицензии до изменения этого параметра, сохраняют свои лицензии.

- Пользователи, у которых есть лицензия Power BI (бесплатная версия), не могут получать лицензии Power BI Pro для частных лиц. 

- Администратору необходимо назначить лицензии Pro всем пользователям, которым они нужны.

### <a name="before-you-begin"></a>Подготовка

В этих инструкциях для изменения значения параметра **AllowSelfServicePurchase** используются команды MSCommerce в PowerShell. Чтобы они стали доступны, необходимо установить модуль MSCommerce PowerShell. Дополнительные сведения об использовании PowerShell см. в статье [Начало работы с Windows PowerShell](/powershell/scripting/getting-started/getting-started-with-windows-powershell).

Чтобы установить модуль MSCommerce, запустите Windows PowerShell от имени администратора. Убедитесь в том, что локальная политика выполнения позволяет выполнять скрипты. Если возникли проблемы, см. раздел [Политики выполнения PowerShell](/powershell/module/microsoft.powershell.core/about/about_execution_policies#powershell-execution-policies), чтобы узнать, как изменить локальную политику.

Чтобы установить модуль MSCommerce, выполните следующую команду:

```powershell
Install-Module -name MSCommerce
```

### <a name="change-the-self-service-signup-policy"></a>Изменение политики самостоятельной регистрации

В PowerShell выполните следующую команду, чтобы подключиться.

```powershell
Connect-MSCommerce
```

Введите учетные данные администратора в диалоговом окне входа и при необходимости пройдите двухфакторную проверку подлинности. После проверки в окне PowerShell отобразится успешное соединение.

Чтобы просмотреть текущее значение параметра, выполните указанную ниже команду. Чтобы предотвратить усечение текста, выходные данные передаются в отформатированный список с помощью параметра fl.

```powershell
Get-MSCommercePolicy -PolicyId AllowSelfServicePurchase | fl
```

Вы можете отключить параметр, который разрешает самостоятельное приобретение для отдельного продукта, указав его идентификатор **ProductId**. Чтобы изменить текущее значение для службы Power BI, выполните следующую команду.

```powershell
Update-MSCommerceProductPolicy -PolicyId AllowSelfServicePurchase -ProductId CFQ7TTC0L3PB -Enabled $False
```

После выполнения этой команды самостоятельное приобретение лицензий Power BI отключается для всех пользователей. Чтобы снова включить ее, выполните эту команду еще раз, задав значение $true.

## <a name="what-to-do-if-individuals-have-already-used-self-service"></a>Что делать, если пользователи уже воспользовались самообслуживанием

Самостоятельная регистрация и приобретение включены по умолчанию. Поэтому у пользователей в организации уже могут быть лицензии и подписки на Power BI. Даже если вы не собираетесь ничего менять, вам необходимо иметь ясное представление о текущем положении дел.

Пользователи, присоединившиеся к клиенту самостоятельно, получают уникальную лицензию, по которой можно отфильтровать список активных пользователей на панели администратора. Чтобы создать представление, выполните описанные ниже действия.

1. Перейдите в Центр администрирования Microsoft 365.

1. В области навигации выберите **Пользователи** > **Активные пользователи**.

1. В меню Представления выберите **Добавление настраиваемого представления**.

1. Присвойте имя новому представлению и в разделе Назначенная лицензия продукта выберите пункт Power BI (free) (Power BI (бесплатная версия)) или Power BI Pro.

    Для одного представления можно выбрать только один тип лицензии. Если у организации есть лицензия на Power BI (free) (Power BI (бесплатная версия)) и на Power BI Pro, вы можете создать два представления.

1. Введите другие требуемые условия и выберите **Добавить**.

    После создания представление будет доступно в меню Представления.


    > [!NOTE]
    > Если у вашей организации нет среды Microsoft 365, подключенной к домену электронной почты, значит, пользователи самообслуживания были добавлены в новый облачный каталог пользователей. Вам может потребоваться найти и [взять под свой контроль уже созданные клиенты](https://docs.microsoft.com/azure/active-directory/users-groups-roles/domains-admin-takeover). 

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о самостоятельном приобретении лицензий на Power BI и другие службы Power Platform см. в следующих статьях:

- [Вопросы и ответы по самостоятельной покупке](/microsoft-365/commerce/subscriptions/self-service-purchase-faq#admin-capabilities)
- [Использование параметра AllowSelfServicePurchase для модуля MSCommerce PowerShell](/microsoft-365/commerce/subscriptions/allowselfservicepurchase-powershell)