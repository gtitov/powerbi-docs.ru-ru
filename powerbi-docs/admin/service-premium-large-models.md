---
title: Большие наборы данных в Power BI Premium
description: Благодаря параметру "Формат хранения большого набора данных" размер наборов данных в Power BI Premium может превышать 10 ГБ.
author: davidiseminger
ms.author: davidi
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-premium
ms.topic: how-to
ms.date: 01/21/2021
ms.custom: references_regions
LocalizationGroup: Premium
ms.openlocfilehash: 4fd953eac998e954579af83f2acec975f66e7436
ms.sourcegitcommit: 77912d4f6ef2a2b1ef8ffccc50691fe5b38ee97a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/22/2021
ms.locfileid: "98687035"
---
# <a name="large-datasets-in-power-bi-premium"></a>Большие наборы данных в Power BI Premium

Наборы данных Power BI могут хранить данные в кэше в памяти с высоким уровнем сжатия для оптимизации производительности запросов, что позволяет поддерживать быстрое взаимодействие с пользователем. При использовании емкости уровня Premium большие наборы данных, превышающие ограничение по умолчанию, можно включить с помощью параметра **Формат хранения большого набора данных**. Если этот параметр включен, размер набора данных ограничен размером *емкости* Premium или максимальным размером, установленным администратором.

Большие наборы данных можно включить для всех номеров SKU Premium P и Embedded A. С точки зрения ограничений размера модели данных ограничение размера большого набора данных в Premium сравнимо с Azure Analysis Services.

Для наборов данных свыше 10 ГБ включение параметра "Формат хранения большого набора данных" имеет дополнительные преимущества. Если для операций записи наборов данных планируется использовать инструменты на основе конечных точек XML, обязательно включите этот параметр даже для наборов данных, которые необязательно характеризуются как *большие* наборы данных. Если этот параметр включен, формат хранения большого набора данных может улучшить производительность операций записи XMLA.

Большие наборы данных в службе не влияют на размер отправки модели Power BI Desktop, который по-прежнему ограничен 10 ГБ. При этом при обновлении службы наборы данных могут превысить это ограничение.

> [!IMPORTANT]
> Power BI Premium поддерживает большие наборы данных. Включите параметр **Формат хранения больших наборов данных**, чтобы использовать в Power BI Premium наборы данных, превышающие ограничение по умолчанию. 


## <a name="enable-large-datasets"></a>Включение больших наборов данных

Здесь описаны действия по включению больших наборов данных для новой модели, опубликованной в службе. Для существующих наборов данных требуется выполнить только шаг 3.

1. Создайте модель в Power BI Desktop. Если набор данных будет больше и потребует больше памяти, обязательно настройте параметр [Добавочное обновление](service-premium-incremental-refresh.md).

1. Опубликуйте модель в службе в качестве набора данных.

1. В службе для набора данных выберите **Настройки**, разверните раздел **Формат хранения большого набора данных**, переведите ползунок в положение **Вкл.** , а затем нажмите **Применить**.

    :::image type="content" source="media/service-premium-large-models/enable-large-dataset.png" alt-text="Включение ползунка больших наборов данных":::

1. Вызов обновления для загрузки исторических данных на основе политики добавочного обновления. Для загрузки журнала первому обновлению может понадобится некоторое время. Последующие обновления должны выполняться быстрее, в зависимости от политики добавочного обновления.

## <a name="set-default-storage-format"></a>Задание формата хранения по умолчанию

Для всех новых наборов данных, созданных в рабочей области и назначенных емкости Premium, можно по умолчанию включить формат хранения большого набора данных.

1. В рабочей области щелкните **Параметры** > **Premium**.

1. В разделе **Формат хранения по умолчанию** выберите **Формат хранения большого набора данных**, а затем нажмите **Сохранить**.

    :::image type="content" source="media/service-premium-large-models/default-storage-format.png" alt-text="Включение формата хранения по умолчанию":::

### <a name="enable-with-powershell"></a>Включение с помощью PowerShell

Включить формат хранения большого набора данных также можно с помощью PowerShell. Для запуска командлетов PowerShell требуются права администратора емкости и администратора рабочей области.

1. Найдите идентификатор набора данных (GUID). Идентификатор можно увидеть в URL-адресе, на вкладке **Наборы данных** для рабочей области в разделе параметров набора данных.

    ![GUID набора данных](media/service-premium-large-models/dataset-guid.png)

1. В командной строке администратора PowerShell установите модуль [MicrosoftPowerBIMgmt](/powershell/module/microsoftpowerbimgmt.data/).

    ```powershell
    Install-Module -Name MicrosoftPowerBIMgmt
    ```

1. Выполните следующие командлеты, чтобы войти и проверить режим хранения набора данных.

    ```powershell
    Login-PowerBIServiceAccount

    (Get-PowerBIDataset -Scope Organization -Id <Dataset ID> -Include actualStorage).ActualStorage
    ```

    Ответ должен выглядеть следующим образом. Режим хранения — ABF (файл резервной копии Analysis Services), который используется по умолчанию.

    ```
    Id                   StorageMode

    --                   -----------

    <Dataset ID>         Abf
    ```

1. Выполните следующие командлеты, чтобы настроить режим хранения. Преобразование в файлы Premium может занять несколько секунд.

    ```powershell
    Set-PowerBIDataset -Id <Dataset ID> -TargetStorageMode PremiumFiles

    (Get-PowerBIDataset -Scope Organization -Id <Dataset ID> -Include actualStorage).ActualStorage
    ```

    Ответ должен выглядеть следующим образом. Теперь для режима хранения заданы файлы Premium.

    ```
    Id                   StorageMode
    
    --                   -----------
    
    <Dataset ID>         PremiumFiles
    ```

Состояние преобразований наборов данных в файлы Premium и из них можно проверить с помощью командлета [Get-PowerBIWorkspaceMigrationStatus](/powershell/module/microsoftpowerbimgmt.workspaces/get-powerbiworkspacemigrationstatus).

## <a name="dataset-eviction"></a>Исключение наборов данных

Power BI использует управление динамической памятью для исключения неактивных наборов данных из памяти. Power BI исключает наборы данных, чтобы они могли загружать другие наборы данных для устранения запросов пользователей. Управление динамической памятью позволяет значительно увеличить сумму размеров набора данных по сравнению с объемом доступной памяти, но один набор данных должен помещаться в памяти. Дополнительные сведения об управлении динамической памятью см. в разделе [Принцип функционирования емкостей](service-premium-what-is.md#how-capacities-function).

Следует учитывать влияние вытеснений на большие модели. Несмотря на относительно быстрое время загрузки набора данных, для пользователей может быть заметной задержка, если они ожидают повторной загрузки больших наборов данных. По этой причине в текущей форме функция больших моделей рекомендуется в первую очередь для производственных мощностей, выделенных для корпоративных требований бизнес-аналитики, а не в сочетании с требованиями самостоятельной бизнес-аналитики. Менее вероятно, что емкость, выделенная для корпоративных требований бизнес-аналитики, будет часто вызывать выгрузку и требовать перезагрузки наборов данных. С другой стороны, емкости для самостоятельной бизнес-аналитики могут иметь небольшие наборы данных, которые чаще всего загружаются в память и выгружаются из нее.

## <a name="checking-dataset-size"></a>Проверка размера набора данных

После загрузки исторических данных вы можете использовать [SSMS](/sql/ssms/download-sql-server-management-studio-ssms) с помощью [конечной точки XML для аналитики](service-premium-connect-tools.md), чтобы проверить оценочный размер набора данных в окне "Свойства модели".

![Примерный размер набора данных](media/service-premium-large-models/estimated-dataset-size.png)

Вы также можете проверить размер набора данных, выполнив следующие запросы динамического административного представления из SSMS. Суммируйте столбцы DICTIONARY\_SIZE и USED\_SIZE на выходе, чтобы увидеть размер набора данных в байтах.

```sql
SELECT * FROM SYSTEMRESTRICTSCHEMA
($System.DISCOVER_STORAGE_TABLE_COLUMNS,
 [DATABASE_NAME] = '<Dataset Name>') //Sum DICTIONARY_SIZE (bytes)

SELECT * FROM SYSTEMRESTRICTSCHEMA
($System.DISCOVER_STORAGE_TABLE_COLUMN_SEGMENTS,
 [DATABASE_NAME] = '<Dataset Name>') //Sum USED_SIZE (bytes)
```

## <a name="limitations-and-considerations"></a>Рекомендации и ограничения

При использовании больших наборов данных учитывайте следующие ограничения.

- **Новые рабочие области являются обязательными**: Большие наборы данных работают только с [новыми рабочими областями](../collaborate-share/service-create-the-new-workspaces.md).

- **Скачивание Power BI Desktop.** Если набор данных хранится в файлах уровня "Премиум", [скачивание в виде PBIX-файла](../create-reports/service-export-to-pbix.md) завершится сбоем.
- **Поддерживаемые регионы**: Большие наборы данных поддерживаются во всех регионах Azure, в которых поддерживается хранилище файлов класса Premium. Дополнительные сведения см. в списке [доступности продуктов по регионам](https://azure.microsoft.com/global-infrastructure/services/?products=storage), а также в таблице в разделе ниже.

- **Настройка максимального размера набора данных**. Максимальный размер набора данных может быть задан администраторами. Максимальное значение можно задать от 0,1 ГБ до максимальной емкости SKU.

## <a name="region-availability"></a>Доступность по регионам

Большие наборы данных в Power BI доступны только в тех регионах Azure, в которых поддерживается [хранилище файлов Azure класса Premium](/azure/storage/files/storage-files-planning#storage-tiers).

В следующем списке перечислены регионы, в которых доступны большие наборы данных Power BI. В регионах, которые не вошли в этот список, большие модели не поддерживаются.

|Регион Azure  |Сокращенное название региона Azure  |
|---------|---------|
|Восточная Австралия     | australiaeast        |
|Australia Southeast     | australiasoutheast        |
|Восточная Канада     | canadaeast        |
|Центральная Канада     | canadacentral        |
|Центральная Индия     | centralindia        |
|Центральная часть США     | centralus        |
|Восточная Азия     | eastasia        |
|Восточная часть США     | eastus        |
|восточная часть США 2     | eastus2        |
|Japan East     | japaneast        |
|Западная Япония     | japanwest        |
|Республика Корея, центральный регион     | koreacentral        |
|Республика Корея, южный регион     | koreasouth        |
|Центрально-северная часть США     | northcentralus        |
|Северная Европа     | northeurope        |
|Центрально-южная часть США     | southcentralus        |
|Southeast Asia     | southeastasia        |
|южная часть Соединенного Королевства     | uksouth        |
|западная часть Соединенного Королевства     | ukwest        |
|Западная Европа     | westeurope        |
|Западная Индия     | westindia        |
|западная часть США     | westus        |
|Западная часть США 2     | westus2        |

## <a name="next-steps"></a>Дальнейшие действия

Следующие ссылки дадут вам полезную информацию для работы с большими моделями.

* [Хранилище файлов Azure класса "Премиум"](/azure/storage/files/storage-files-planning#storage-tiers)
* [Настройка поддержки нескольких регионов для Power BI Premium](service-admin-premium-multi-geo.md)
* [Использование собственных ключей шифрования для Power BI](service-encryption-byok.md)
* [Принцип функционирования емкостей](service-premium-what-is.md#how-capacities-function)
* [Добавочное обновление](service-premium-incremental-refresh.md)

Power BI предоставили Power BI Premium 2-го поколения в предварительной версии, чтобы улучшить работу с Power BI Premium, включая следующие возможности:
* Производительность
* Пользовательские лицензии
* Больший масштаб
* Улучшенные метрики
* Автомасштабирование
* Снижение издержек на управление

Дополнительные сведения см. в разделе о [емкости Power BI Premium 2-го поколения (предварительная версия)](service-premium-what-is.md#power-bi-premium-generation-2-preview).
